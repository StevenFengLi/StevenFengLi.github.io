<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>天河区热力监测</title>
        <style>
            html,body{
                height:100%;
            }
            *{
                margin:0px;
                height:0px;
            }
            #map{
                margin:0 auto;
                width:800px;
                height:600px;
                border:1px solid red;
            }
        </style>
        <script src="./static/js/echarts.min.js"></script>
        <script src="./static/js/jquery.min.js"></script>
    </head>
    <body>
        <div id="map" class='container'></div>
        <script>
        var geoCoordMap={
            'test1':[113.3281983,23.15928249],
            'test2':[113.3294177,23.15628268],
            'test3':[113.326288,23.154406],
            'test4':[113.324519,23.15711676],
            'test5':[113.313361,23.15828445],
            'test6':[113.3151299,23.15953554],
            'test7':[113.3058769,23.15628268],
            'test8':[113.302475,23.15407236],
            'test9':[113.2988917,23.1526544],
            'test10':[113.306013,23.15048573],
            'test11':[113.3112291,23.15198712],
            'test12':[113.3149938,23.15131984],
            'test13':[113.3163546,23.15544861],
            'test14':[113.3183957,23.15390555],
            'test15':[113.3212986,23.15011038],
            'test16':[113.3247912,23.14865067],
            'test17':[113.3289641,23.14898432],
            'test18':[113.3106848,23.14681559]
        };
        var locValue=[
            {name:"test1",value:"14"},
            {name:"test2",value:"20"},
            {name:"test3",value:"29"},
            {name:"test4",value:"10"},
            {name:"test5",value:"20"},
            {name:"test6",value:"30"},
            {name:"test7",value:"40"},
            {name:"test8",value:"50"},
            {name:"test9",value:"40"},
            {name:"test10",value:"30"},
            {name:"test11",value:"20"},
            {name:"test12",value:"10"},
            {name:"test13",value:"25"},
            {name:"test14",value:"35"},
            {name:"test15",value:"45"},
            {name:"test16",value:"5"},
            {name:"test17",value:"13"},
            {name:"test18",value:"23"},
        ];
        var convertData = function(geoCoordMap,locValue){
            var res=[];
            for (var i=0;i<locValue.length;i++){
                var geoCoord =geoCoordMap[locValue[i].name];//得到对应的经纬度坐标
                if (geoCoord){
                    res.push(
                        {
                            name:locValue[i].name,
                            value:geoCoord.concat(locValue[i].value)
                        }
                    );
                }

            }
            return res;
        };
        //JSON
        $.getJSON('./static/map/tianhe.json',function(data){
            echarts.registerMap('tianhe',data);
            var chart = echarts.init(document.getElementById('map'));
            var option={
                backgroundColor:'#404a59',
                title:{
                    text:'天河区热力监测',
                    x:'center',
                    textStyle:{
                        color:'#fff'
                    }
                },
                //鼠标显示对应的值
                tooltip:{
                    trigger:'item',
                    formatter:function(params){
                        return params.name+' : '+params.value[2];
                    },
                    extraCssText:"height:20px;"
                },
                //点开关
                legend: {
                    orient: 'vertical',
                    y: 'bottom',
                    x:'right',
                    data:['温度'],
                    textStyle: {
                        color: '#fff'
                    }
                },
                //柱状图例
                visualMap: {
                    min: 0,
                    max: 50,
                    calculable: true,
                    inRange: {
                        color: ['#50a3ba', '#eac736', '#d94e5d']
                    },
                    textStyle: {
                        color: '#fff'
                    }
                },
                //地图
                geo: {
                    map: 'tianhe',
                    roam:true,
                    aspectScale:1,
                    label: {
                        emphasis: {
                            show: true,
                            color:"#fff"

                        }
                    },
                    itemStyle: {
                        normal: {
                            areaColor: '#323c48',
                            borderColor: '#111'
                        },
                        emphasis: {
                            areaColor: '#2a333d'
                        }
                    }
                },
                series:[
                    {
                        name: '温度',
                        type: 'effectScatter',
                        coordinateSystem: 'geo',
                        data: convertData(geoCoordMap,locValue).slice(0,4),
                        symbolSize: 12,
                        label: {
                            normal: {
                                show: false //false  直接在圆心中间显示label
                            },
                            emphasis: {
                                show: false //false  鼠标移到圆心中间显示圆心中间的label
                            }
                        },
                        itemStyle: {
                            emphasis: {
                                borderColor: '#fff',
                                borderWidth: 1
                            }
                        }
                    },

                    {
                        name: '温度',
                            type: 'scatter',
                        coordinateSystem: 'geo',
                            data: convertData(geoCoordMap,locValue).slice(4,8),
                        symbolSize: 12,
                        label: {
                        normal: {
                            show: false
                        },
                        emphasis: {
                            show: false
                        }
                    },
                        itemStyle: {
                            emphasis: {
                                borderColor: '#fff',
                                    borderWidth: 1
                            }
                        }
                    },

                    { //没有visualMap的情况，同颜色大小标识不同的等级
                        name: '温度',
                        type: 'scatter',
                        coordinateSystem: 'geo',
                        data: convertData(geoCoordMap,locValue).slice(8,12),
                        symbolSize: function (val) {
                            return val[2] / 5; //10
                        },
                        label: {
                            normal: {
                                formatter: '{b}',
                                position: 'right',
                                show: false//false
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        itemStyle: {
                            normal: {
                                color: '#ddb926'
                            }
                        }
                    },
                    
                    {
                        name: '温度',
                        type: 'effectScatter',
                        coordinateSystem: 'geo',
                        data: convertData(geoCoordMap,locValue).slice(12,18),
                        symbolSize: function (val) {
                            return 10;  // val[2] / 10
                        },
                        showEffectOn: 'emphasis',
                        rippleEffect: {
                            brushType: 'stroke'
                        },
                        hoverAnimation: true,
                        label: {
                            normal: {
                                formatter: '{b}',
                                position: 'right',
                                show: true
                            }
                        },
                        itemStyle: {
                            normal: {
                                color: '#f4e925',
                                shadowBlur: 10,
                                shadowColor: '#333'
                            }
                        },
                        zlevel: 1
                    },                  
                ]

            };
            chart.setOption(option);
        });
        </script>

    </body>
</html>